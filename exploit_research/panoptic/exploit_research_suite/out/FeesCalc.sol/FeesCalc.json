{"abi":[{"type":"function","name":"calculateAMMSwapFeesLiquidityChunk","inputs":[{"name":"univ3pool","type":"IUniswapV3Pool","internalType":"contract IUniswapV3Pool"},{"name":"currentTick","type":"int24","internalType":"int24"},{"name":"startingLiquidity","type":"uint128","internalType":"uint128"},{"name":"liquidityChunk","type":"uint256","internalType":"uint256"}],"outputs":[{"name":"feesEachToken","type":"int256","internalType":"int256"}],"stateMutability":"view"}],"bytecode":{"object":"0x6105c061003a600b82828239805160001a60731461002d57634e487b7160e01b600052600060045260246000fd5b30600052607381538281f3fe73000000000000000000000000000000000000000030146080604052600436106100355760003560e01c8063ab5dbb041461003a575b600080fd5b61004d610048366004610456565b61005f565b60405190815260200160405180910390f35b600080600061008287876100738760e81c90565b61007d8860d01c90565b6100ee565b915091506100e36100a582876fffffffffffffffffffffffffffffffff16610369565b6100db6100c485896fffffffffffffffffffffffffffffffff16610369565b6fffffffffffffffffffffffffffffffff16860190565b9060801b0190565b979650505050505050565b6040517ff30dba93000000000000000000000000000000000000000000000000000000008152600283900b600482015260009081908190819073ffffffffffffffffffffffffffffffffffffffff89169063f30dba939060240161010060405180830381865afa158015610166573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061018a91906104c3565b50506040517ff30dba9300000000000000000000000000000000000000000000000000000000815260028c900b6004820152939750919550600094508493505073ffffffffffffffffffffffffffffffffffffffff8c169163f30dba93915060240161010060405180830381865afa15801561020a573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061022e91906104c3565b505050509350935050508760020b8960020b1215610255578184039550808303945061035c565b8660020b8960020b12610271578382039550828103945061035c565b81848b73ffffffffffffffffffffffffffffffffffffffff1663f30583996040518163ffffffff1660e01b8152600401602060405180830381865afa1580156102be573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906102e29190610571565b0303955080838b73ffffffffffffffffffffffffffffffffffffffff1663461413196040518163ffffffff1660e01b8152600401602060405180830381865afa158015610333573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906103579190610571565b030394505b5050505094509492505050565b600080807fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff848609848602925082811083820303915050806000036103b3575060801c905061040d565b80700100000000000000000000000000000000116103d057600080fd5b600070010000000000000000000000000000000085870980840360801c931090910370010000000000000000000000000000000002919091179150505b92915050565b73ffffffffffffffffffffffffffffffffffffffff8116811461043557600080fd5b50565b6fffffffffffffffffffffffffffffffff8116811461043557600080fd5b6000806000806080858703121561046c57600080fd5b843561047781610413565b93506020850135600281900b811461048e57600080fd5b9250604085013561049e81610438565b9396929550929360600135925050565b805180151581146104be57600080fd5b919050565b600080600080600080600080610100898b0312156104e057600080fd5b88516104eb81610438565b80985050602089015180600f0b811461050357600080fd5b80975050604089015195506060890151945060808901518060060b811461052957600080fd5b60a08a015190945061053a81610413565b60c08a015190935063ffffffff8116811461055457600080fd5b915061056260e08a016104ae565b90509295985092959890939650565b60006020828403121561058357600080fd5b505191905056fea26469706673582212207927a89e74cbac276b5fd241cf4ea11ff5035af4b128514e4b7a9fe1f475010b64736f6c63430008120033","sourceMap":"1754:7643:4:-:0;;;;;;;;;;;;;;;-1:-1:-1;;;1754:7643:4;;;;;;;;;;;;;;;;;","linkReferences":{}},"deployedBytecode":{"object":"0x73000000000000000000000000000000000000000030146080604052600436106100355760003560e01c8063ab5dbb041461003a575b600080fd5b61004d610048366004610456565b61005f565b60405190815260200160405180910390f35b600080600061008287876100738760e81c90565b61007d8860d01c90565b6100ee565b915091506100e36100a582876fffffffffffffffffffffffffffffffff16610369565b6100db6100c485896fffffffffffffffffffffffffffffffff16610369565b6fffffffffffffffffffffffffffffffff16860190565b9060801b0190565b979650505050505050565b6040517ff30dba93000000000000000000000000000000000000000000000000000000008152600283900b600482015260009081908190819073ffffffffffffffffffffffffffffffffffffffff89169063f30dba939060240161010060405180830381865afa158015610166573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061018a91906104c3565b50506040517ff30dba9300000000000000000000000000000000000000000000000000000000815260028c900b6004820152939750919550600094508493505073ffffffffffffffffffffffffffffffffffffffff8c169163f30dba93915060240161010060405180830381865afa15801561020a573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061022e91906104c3565b505050509350935050508760020b8960020b1215610255578184039550808303945061035c565b8660020b8960020b12610271578382039550828103945061035c565b81848b73ffffffffffffffffffffffffffffffffffffffff1663f30583996040518163ffffffff1660e01b8152600401602060405180830381865afa1580156102be573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906102e29190610571565b0303955080838b73ffffffffffffffffffffffffffffffffffffffff1663461413196040518163ffffffff1660e01b8152600401602060405180830381865afa158015610333573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906103579190610571565b030394505b5050505094509492505050565b600080807fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff848609848602925082811083820303915050806000036103b3575060801c905061040d565b80700100000000000000000000000000000000116103d057600080fd5b600070010000000000000000000000000000000085870980840360801c931090910370010000000000000000000000000000000002919091179150505b92915050565b73ffffffffffffffffffffffffffffffffffffffff8116811461043557600080fd5b50565b6fffffffffffffffffffffffffffffffff8116811461043557600080fd5b6000806000806080858703121561046c57600080fd5b843561047781610413565b93506020850135600281900b811461048e57600080fd5b9250604085013561049e81610438565b9396929550929360600135925050565b805180151581146104be57600080fd5b919050565b600080600080600080600080610100898b0312156104e057600080fd5b88516104eb81610438565b80985050602089015180600f0b811461050357600080fd5b80975050604089015195506060890151945060808901518060060b811461052957600080fd5b60a08a015190945061053a81610413565b60c08a015190935063ffffffff8116811461055457600080fd5b915061056260e08a016104ae565b90509295985092959890939650565b60006020828403121561058357600080fd5b505191905056fea26469706673582212207927a89e74cbac276b5fd241cf4ea11ff5035af4b128514e4b7a9fe1f475010b64736f6c63430008120033","sourceMap":"1754:7643:4:-:0;;;;;;;;;;;;;;;;;;;;;;;;2851:1155;;;;;;:::i;:::-;;:::i;:::-;;;1163:25:92;;;1151:2;1136:18;2851:1155:4;;;;;;;;3050:20;3265:31;3310;3354:194;3408:9;3435:11;3464:26;:14;5129:3:11;5121:11;;5004:147;3464:26:4;3508;:14;5421:3:11;5413:11;;5296:147;3508:26:4;3354:36;:194::i;:::-;3251:297;;;;3785:214;3938:58;3953:23;3978:17;3938:58;;:14;:58::i;:::-;3785:114;3838:58;3853:23;3878:17;3838:58;;:14;:58::i;:::-;779:34:10;3843:35;3835:44;;;3634:262;3785:114:4;:138;6337:3:10;6321:19;6313:28;;6195:163;3785:214:4;3769:230;2851:1155;-1:-1:-1;;;;;;;2851:1155:4:o;4700:4695::-;5539:26;;;;;1370:1:92;1359:21;;;5539:26:4;;;1341:40:92;4886:28:4;;;;;;;;5539:15;;;;;;1314:18:92;;5539:26:4;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;-1:-1:-1;;5628:26:4;;;;;1370:1:92;1359:21;;;5628:26:4;;;1341:40:92;5486:79:4;;-1:-1:-1;5486:79:4;;-1:-1:-1;5580:17:4;;-1:-1:-1;5580:17:4;;-1:-1:-1;;5628:15:4;;;;;;-1:-1:-1;1314:18:92;;5628:26:4;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;5575:79;;;;;;;;;;5806:9;5792:23;;:11;:23;;;5788:3591;;;6875:9;6863;:21;6840:44;;6968:9;6956;:21;6933:44;;5788:3591;;;7017:9;7002:24;;:11;:24;;;6998:2381;;7917:9;7905;:21;7882:44;;7979:9;7967;:21;7944:44;;6998:2381;;;9258:9;9246;9211;:30;;;:32;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;:44;:56;9188:79;;9355:9;9343;9308;:30;;;:32;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;:44;:56;9285:79;;6998:2381;4946:4449;;;;4700:4695;;;;;;;:::o;19805:2555:5:-;19869:14;;;20451:6;20448:1;20445;20438:20;20491:1;20488;20484:9;20475:18;;20546:5;20542:2;20539:13;20531:5;20527:2;20523:14;20519:34;20510:43;;;20647:5;20656:1;20647:10;20643:262;;-1:-1:-1;20831:3:5;20827:15;;-1:-1:-1;20877:13:5;;20643:262;20995:5;20984:8;:16;20976:25;;;;;;21302:17;21402:35;21399:1;21396;21389:49;21634:21;;;21963:3;21959:15;21587:20;-1:-1:-1;21576:32:5;;;22308:8;22300:16;22291:25;;;;;-1:-1:-1;;19805:2555:5;;;;;:::o;14:170:92:-;116:42;109:5;105:54;98:5;95:65;85:93;;174:1;171;164:12;85:93;14:170;:::o;189:146::-;275:34;268:5;264:46;257:5;254:57;244:85;;325:1;322;315:12;340:666;448:6;456;464;472;525:3;513:9;504:7;500:23;496:33;493:53;;;542:1;539;532:12;493:53;581:9;568:23;600:47;641:5;600:47;:::i;:::-;666:5;-1:-1:-1;723:2:92;708:18;;695:32;769:1;758:22;;;746:35;;736:63;;795:1;792;785:12;736:63;818:7;-1:-1:-1;877:2:92;862:18;;849:32;890:33;849:32;890:33;:::i;:::-;340:666;;;;-1:-1:-1;942:7:92;;996:2;981:18;968:32;;-1:-1:-1;;340:666:92:o;1392:164::-;1468:13;;1517;;1510:21;1500:32;;1490:60;;1546:1;1543;1536:12;1490:60;1392:164;;;:::o;1561:1098::-;1687:6;1695;1703;1711;1719;1727;1735;1743;1796:3;1784:9;1775:7;1771:23;1767:33;1764:53;;;1813:1;1810;1803:12;1764:53;1845:9;1839:16;1864:31;1889:5;1864:31;:::i;:::-;1914:5;1904:15;;;1964:2;1953:9;1949:18;1943:25;2014:7;2010:2;1999:23;1990:7;1987:36;1977:64;;2037:1;2034;2027:12;1977:64;2060:7;2050:17;;;2107:2;2096:9;2092:18;2086:25;2076:35;;2151:2;2140:9;2136:18;2130:25;2120:35;;2200:3;2189:9;2185:19;2179:26;2250:7;2247:1;2236:22;2227:7;2224:35;2214:63;;2273:1;2270;2263:12;2214:63;2348:3;2333:19;;2327:26;2296:7;;-1:-1:-1;2362:49:92;2327:26;2362:49;:::i;:::-;2482:3;2467:19;;2461:26;2430:7;;-1:-1:-1;2531:10:92;2518:24;;2506:37;;2496:65;;2557:1;2554;2547:12;2496:65;2580:7;-1:-1:-1;2606:47:92;2648:3;2633:19;;2606:47;:::i;:::-;2596:57;;1561:1098;;;;;;;;;;;:::o;2664:184::-;2734:6;2787:2;2775:9;2766:7;2762:23;2758:32;2755:52;;;2803:1;2800;2793:12;2755:52;-1:-1:-1;2826:16:92;;2664:184;-1:-1:-1;2664:184:92:o","linkReferences":{}},"methodIdentifiers":{"calculateAMMSwapFeesLiquidityChunk(IUniswapV3Pool,int24,uint128,uint256)":"ab5dbb04"},"rawMetadata":"{\"compiler\":{\"version\":\"0.8.18+commit.87f61d96\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"inputs\":[{\"internalType\":\"contract IUniswapV3Pool\",\"name\":\"univ3pool\",\"type\":\"IUniswapV3Pool\"},{\"internalType\":\"int24\",\"name\":\"currentTick\",\"type\":\"int24\"},{\"internalType\":\"uint128\",\"name\":\"startingLiquidity\",\"type\":\"uint128\"},{\"internalType\":\"uint256\",\"name\":\"liquidityChunk\",\"type\":\"uint256\"}],\"name\":\"calculateAMMSwapFeesLiquidityChunk\",\"outputs\":[{\"internalType\":\"int256\",\"name\":\"feesEachToken\",\"type\":\"int256\"}],\"stateMutability\":\"view\",\"type\":\"function\"}],\"devdoc\":{\"author\":\"Axicon Labs Limited\",\"details\":\"@dev          When price tick moves withinthis liquidity chunk == an option leg within a `tokenId` option position:Fees accumulate.\\u25c4\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u25baliquidity  \\u250c\\u2500\\u2500\\u2500\\u253c\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2510\\u25b2     \\u2502   \\u2502        \\u2502\\u2502     \\u2502   :        \\u25c4\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500Liquidity chunk\\u2502     \\u2502   \\u2502        \\u2502      (an option position leg)\\u2502   \\u250c\\u2500\\u2534\\u2500\\u2500\\u2500\\u253c\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2534\\u2500\\u2510\\u2502   \\u2502     \\u2502          \\u2502\\u2502   \\u2502     :          \\u2502\\u2502   \\u2502     \\u2502          \\u2502\\u2502   \\u2502     :          \\u2502\\u2502   \\u2502     \\u2502          \\u2502\\u2514\\u2500\\u2500\\u2500\\u2534\\u2500\\u2500\\u2500\\u2500\\u2500\\u2534\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2534\\u2500\\u2500\\u2500\\u2500\\u25ba price\\u25b2\\u2502Current price tickof the AMM@dev Collect fees accumulated within option position legs (a leg is a liquidity chunk)\",\"kind\":\"dev\",\"methods\":{\"calculateAMMSwapFeesLiquidityChunk(IUniswapV3Pool,int24,uint128,uint256)\":{\"details\":\"read from the uniswap pool and compute the accumulated fees from swapping activity.\",\"params\":{\"currentTick\":\"the current price tick\",\"liquidityChunk\":\"the chunk of liquidity of the option position leg deployed in the AMM\",\"startingLiquidity\":\"the liquidity of the option position leg deployed in the AMM\",\"univ3pool\":\"the AMM/Uniswap pool where fees are collected from\"},\"returns\":{\"feesEachToken\":\"the fees collected from the AMM for each token (LeftRight-packed) with token0 in the right slot and token1 in the left slot\"}}},\"title\":\"Library for Fee Calculations.\",\"version\":1},\"userdoc\":{\"kind\":\"user\",\"methods\":{\"calculateAMMSwapFeesLiquidityChunk(IUniswapV3Pool,int24,uint128,uint256)\":{\"notice\":\"Calculate the AMM Swap/trading fees for a `liquidityChunk` of each token.\"}},\"notice\":\"Some options positions involve moving liquidity chunks to the AMM/Uniswap. Those chunks can then earn AMM swap fees.\",\"version\":1}},\"settings\":{\"compilationTarget\":{\"contracts/libraries/FeesCalc.sol\":\"FeesCalc\"},\"evmVersion\":\"paris\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\"},\"optimizer\":{\"enabled\":true,\"runs\":18000},\"remappings\":[\":@contracts/=contracts/\",\":@libraries/=contracts/libraries/\",\":@multicall/=contracts/multicall/\",\":@openzeppelin/=lib/openzeppelin-contracts/\",\":@periphery/=contracts/periphery/\",\":@scripts/=scripts/\",\":@testUtils/=test/foundry/testUtils/\",\":@tokens/=contracts/tokens/\",\":@types/=contracts/types/\",\":@uniswap/=lib/\",\":ds-test/=lib/forge-std/lib/ds-test/src/\",\":forge-std/=lib/forge-std/src/\",\":openzeppelin-contracts/=lib/openzeppelin-contracts/\",\":solmate/=lib/solmate/src/\",\":univ3-core/=lib/v3-core/contracts/\",\":univ3-periphery/=lib/v3-periphery/contracts/\",\":v3-core/=lib/v3-core/contracts/\",\":v3-periphery/=lib/v3-periphery/contracts/\"]},\"sources\":{\"contracts/libraries/Constants.sol\":{\"keccak256\":\"0x23144978ba9ba9656514741ce4c9489720d1c4bcacafa0402e160805e547b71a\",\"license\":\"GPL-2.0-or-later\",\"urls\":[\"bzz-raw://944d711e4be30582f55063f2b6f41902c68d52e7f32a075b7f499405dc1c7f0b\",\"dweb:/ipfs/QmWjYNrcQ8bKazZZktHV4iwCpRyCTfVUoMLSZzYEBRAyYj\"]},\"contracts/libraries/Errors.sol\":{\"keccak256\":\"0xc726df9eeff396c5f90d831ce0f22d13c1373efdc729418d58ab534b403d86fc\",\"license\":\"GPL-2.0-or-later\",\"urls\":[\"bzz-raw://a8e98110a218b49dac5c8e0ab99892be1d3b4baf7490293314ff09e3eac14da7\",\"dweb:/ipfs/QmbSgGUiWfuN4mgghXpuPnVjYFL3pQkncv6FXoHWb8Wocv\"]},\"contracts/libraries/FeesCalc.sol\":{\"keccak256\":\"0x40071c56796b4a18e5ccaf3d5bdf9dcc3c3875a4fc6286fa56460384353365c5\",\"license\":\"BUSL-1.1\",\"urls\":[\"bzz-raw://f5490a4e42741a23d2c761d06ac31746d78fc4e4a71a3df31a591eec6fee99fe\",\"dweb:/ipfs/QmVXZcSYwgPvGxTZTAuh5ACPUf7wHtnYmybzDiGwoUHc8x\"]},\"contracts/libraries/Math.sol\":{\"keccak256\":\"0x5dd5d976b4336f5bcb29de6da08182343469ec9bc5c2d08fdf987dd8482776ef\",\"license\":\"GPL-2.0-or-later\",\"urls\":[\"bzz-raw://88bc2a99a41d6a18b6566895fb0449dbe232d108a146dde57c517670b220f340\",\"dweb:/ipfs/QmePC1zK6G1Vtha5Y7AW9uimAg9E6abMZu3Na2KekExdXM\"]},\"contracts/types/LeftRight.sol\":{\"keccak256\":\"0x66c7c6b550e11319f5e3b6ac45e4dc4bf12a2e3fae6c9ea5cf8a749fce343f2f\",\"license\":\"GPL-2.0-or-later\",\"urls\":[\"bzz-raw://488ee146168449606092504247b1ff89e47a12509a6af89e028e64284517c581\",\"dweb:/ipfs/Qmd6iMX9qLdFsfy6QFmHN8dAWVK2TasZn4uHPkz939aXDT\"]},\"contracts/types/LiquidityChunk.sol\":{\"keccak256\":\"0xb98e60d6d9d1a9051a4d9708269d17e117f18d9d04c00a02143ffa050b30b777\",\"license\":\"GPL-2.0-or-later\",\"urls\":[\"bzz-raw://c90ee16357cba73647604aff7606cd9bc3969b38f8e1b68086bb9f48f6835455\",\"dweb:/ipfs/QmQdYVMH8drJX8tawjrJAMDvuSPNGENTSexuinkt8s3vMV\"]},\"contracts/types/TokenId.sol\":{\"keccak256\":\"0x0d258e512399e1e510a4782faac8d822eefb74bf42968733f66180bee57d20e0\",\"license\":\"GPL-2.0-or-later\",\"urls\":[\"bzz-raw://0348a30fedbea579320af2e7b3518296e640097e97763a10af3185302056bd45\",\"dweb:/ipfs/QmXWsaSFbhg8d2pdo7bDwvsD1gVWqPUw4ZK94qXEFEevQw\"]},\"lib/v3-core/contracts/interfaces/IUniswapV3Pool.sol\":{\"keccak256\":\"0x4e64844c56061cd90e0a80de73534a9166704c43eed579eb83f90bc2780ce968\",\"license\":\"GPL-2.0-or-later\",\"urls\":[\"bzz-raw://cba4fab5cebdddf644b901994a7f0f52b98885d4c56012f4dc51d52c2bf9de0e\",\"dweb:/ipfs/QmVyyrRmqXrAiapewWunRVgiPVFJHpH2hKiE1py1svMSNV\"]},\"lib/v3-core/contracts/interfaces/pool/IUniswapV3PoolActions.sol\":{\"keccak256\":\"0x9453dd0e7442188667d01d9b65de3f1e14e9511ff3e303179a15f6fc267f7634\",\"license\":\"GPL-2.0-or-later\",\"urls\":[\"bzz-raw://982f4328f956c3e60e67501e759eb292ac487f76460c774c50e9ae4fcc92aae5\",\"dweb:/ipfs/QmRnzEDsaqtd9PJEVcgQi7p5aV5pMSvRUoGZJAdwFUJxgZ\"]},\"lib/v3-core/contracts/interfaces/pool/IUniswapV3PoolDerivedState.sol\":{\"keccak256\":\"0xe603ac5b17ecdee73ba2b27efdf386c257a19c14206e87eee77e2017b742d9e5\",\"license\":\"GPL-2.0-or-later\",\"urls\":[\"bzz-raw://8febc9bdb399a4d94bb89f5377732652e2400e4a8dee808201ade6848f9004e7\",\"dweb:/ipfs/QmaKDqYYFU4d2W2iN77aDHptfbFmYZRrMYXHeGpJmM8C1c\"]},\"lib/v3-core/contracts/interfaces/pool/IUniswapV3PoolErrors.sol\":{\"keccak256\":\"0xf80abf13fb1fafc127ba4e792f240dd8ea7c8c893978cdfd8439c27fae9a037b\",\"license\":\"GPL-2.0-or-later\",\"urls\":[\"bzz-raw://b04fc72a656bbf3631e9c2e67b9870a2d9d235185e833fe050e9606e6816a9aa\",\"dweb:/ipfs/QmUcz4bkEkJ9pwzFu1C3n97hBQ3st9U6qTAqCdyFwddKco\"]},\"lib/v3-core/contracts/interfaces/pool/IUniswapV3PoolEvents.sol\":{\"keccak256\":\"0x8071514d0fe5d17d6fbd31c191cdfb703031c24e0ece3621d88ab10e871375cd\",\"license\":\"GPL-2.0-or-later\",\"urls\":[\"bzz-raw://d0b571930cc7488b1d546a7e9cea7c52d8b3c4e207da657ed0e0db7343b8cd03\",\"dweb:/ipfs/QmaGK6vVwB95QSTR1XMYvrh7ivYAYZxi3fD7v6VMA4jZ39\"]},\"lib/v3-core/contracts/interfaces/pool/IUniswapV3PoolImmutables.sol\":{\"keccak256\":\"0xf6e5d2cd1139c4c276bdbc8e1d2b256e456c866a91f1b868da265c6d2685c3f7\",\"license\":\"GPL-2.0-or-later\",\"urls\":[\"bzz-raw://b99c8c9ae8e27ee6559e5866bea82cbc9ffc8247f8d15b7422a4deb287d4d047\",\"dweb:/ipfs/QmfL8gaqt3ffAnm6nVj5ksuNpLygXuL3xq5VBqrkwC2JJ3\"]},\"lib/v3-core/contracts/interfaces/pool/IUniswapV3PoolOwnerActions.sol\":{\"keccak256\":\"0x759b78a2918af9e99e246dc3af084f654e48ef32bb4e4cb8a966aa3dcaece235\",\"license\":\"GPL-2.0-or-later\",\"urls\":[\"bzz-raw://64144fb96e1c7fdba87305acadb98a198d26a3d46c097cb3a666e567f6f29735\",\"dweb:/ipfs/QmUnWVwN9FKB9uV5Pr8YfLpWZnYM2DENnRMaadZ492JS9u\"]},\"lib/v3-core/contracts/interfaces/pool/IUniswapV3PoolState.sol\":{\"keccak256\":\"0x44fa2ce1182f6c2f6bead3d1737804bf7e112252ae86e0f2e92f9b8249603f43\",\"license\":\"GPL-2.0-or-later\",\"urls\":[\"bzz-raw://54154e8665b98d65f5dc91b256551852cb47882180b501b260657122d207c0ea\",\"dweb:/ipfs/QmcfemK1A2PXYrWB5SBFGERpMCderbFRb8BtTzQDj1sUBp\"]}},\"version\":1}","metadata":{"compiler":{"version":"0.8.18+commit.87f61d96"},"language":"Solidity","output":{"abi":[{"inputs":[{"internalType":"contract IUniswapV3Pool","name":"univ3pool","type":"IUniswapV3Pool"},{"internalType":"int24","name":"currentTick","type":"int24"},{"internalType":"uint128","name":"startingLiquidity","type":"uint128"},{"internalType":"uint256","name":"liquidityChunk","type":"uint256"}],"stateMutability":"view","type":"function","name":"calculateAMMSwapFeesLiquidityChunk","outputs":[{"internalType":"int256","name":"feesEachToken","type":"int256"}]}],"devdoc":{"kind":"dev","methods":{"calculateAMMSwapFeesLiquidityChunk(IUniswapV3Pool,int24,uint128,uint256)":{"details":"read from the uniswap pool and compute the accumulated fees from swapping activity.","params":{"currentTick":"the current price tick","liquidityChunk":"the chunk of liquidity of the option position leg deployed in the AMM","startingLiquidity":"the liquidity of the option position leg deployed in the AMM","univ3pool":"the AMM/Uniswap pool where fees are collected from"},"returns":{"feesEachToken":"the fees collected from the AMM for each token (LeftRight-packed) with token0 in the right slot and token1 in the left slot"}}},"version":1},"userdoc":{"kind":"user","methods":{"calculateAMMSwapFeesLiquidityChunk(IUniswapV3Pool,int24,uint128,uint256)":{"notice":"Calculate the AMM Swap/trading fees for a `liquidityChunk` of each token."}},"version":1}},"settings":{"remappings":["@contracts/=contracts/","@libraries/=contracts/libraries/","@multicall/=contracts/multicall/","@openzeppelin/=lib/openzeppelin-contracts/","@periphery/=contracts/periphery/","@scripts/=scripts/","@testUtils/=test/foundry/testUtils/","@tokens/=contracts/tokens/","@types/=contracts/types/","@uniswap/=lib/","ds-test/=lib/forge-std/lib/ds-test/src/","forge-std/=lib/forge-std/src/","openzeppelin-contracts/=lib/openzeppelin-contracts/","solmate/=lib/solmate/src/","univ3-core/=lib/v3-core/contracts/","univ3-periphery/=lib/v3-periphery/contracts/","v3-core/=lib/v3-core/contracts/","v3-periphery/=lib/v3-periphery/contracts/"],"optimizer":{"enabled":true,"runs":18000},"metadata":{"bytecodeHash":"ipfs"},"compilationTarget":{"contracts/libraries/FeesCalc.sol":"FeesCalc"},"libraries":{}},"sources":{"contracts/libraries/Constants.sol":{"keccak256":"0x23144978ba9ba9656514741ce4c9489720d1c4bcacafa0402e160805e547b71a","urls":["bzz-raw://944d711e4be30582f55063f2b6f41902c68d52e7f32a075b7f499405dc1c7f0b","dweb:/ipfs/QmWjYNrcQ8bKazZZktHV4iwCpRyCTfVUoMLSZzYEBRAyYj"],"license":"GPL-2.0-or-later"},"contracts/libraries/Errors.sol":{"keccak256":"0xc726df9eeff396c5f90d831ce0f22d13c1373efdc729418d58ab534b403d86fc","urls":["bzz-raw://a8e98110a218b49dac5c8e0ab99892be1d3b4baf7490293314ff09e3eac14da7","dweb:/ipfs/QmbSgGUiWfuN4mgghXpuPnVjYFL3pQkncv6FXoHWb8Wocv"],"license":"GPL-2.0-or-later"},"contracts/libraries/FeesCalc.sol":{"keccak256":"0x40071c56796b4a18e5ccaf3d5bdf9dcc3c3875a4fc6286fa56460384353365c5","urls":["bzz-raw://f5490a4e42741a23d2c761d06ac31746d78fc4e4a71a3df31a591eec6fee99fe","dweb:/ipfs/QmVXZcSYwgPvGxTZTAuh5ACPUf7wHtnYmybzDiGwoUHc8x"],"license":"BUSL-1.1"},"contracts/libraries/Math.sol":{"keccak256":"0x5dd5d976b4336f5bcb29de6da08182343469ec9bc5c2d08fdf987dd8482776ef","urls":["bzz-raw://88bc2a99a41d6a18b6566895fb0449dbe232d108a146dde57c517670b220f340","dweb:/ipfs/QmePC1zK6G1Vtha5Y7AW9uimAg9E6abMZu3Na2KekExdXM"],"license":"GPL-2.0-or-later"},"contracts/types/LeftRight.sol":{"keccak256":"0x66c7c6b550e11319f5e3b6ac45e4dc4bf12a2e3fae6c9ea5cf8a749fce343f2f","urls":["bzz-raw://488ee146168449606092504247b1ff89e47a12509a6af89e028e64284517c581","dweb:/ipfs/Qmd6iMX9qLdFsfy6QFmHN8dAWVK2TasZn4uHPkz939aXDT"],"license":"GPL-2.0-or-later"},"contracts/types/LiquidityChunk.sol":{"keccak256":"0xb98e60d6d9d1a9051a4d9708269d17e117f18d9d04c00a02143ffa050b30b777","urls":["bzz-raw://c90ee16357cba73647604aff7606cd9bc3969b38f8e1b68086bb9f48f6835455","dweb:/ipfs/QmQdYVMH8drJX8tawjrJAMDvuSPNGENTSexuinkt8s3vMV"],"license":"GPL-2.0-or-later"},"contracts/types/TokenId.sol":{"keccak256":"0x0d258e512399e1e510a4782faac8d822eefb74bf42968733f66180bee57d20e0","urls":["bzz-raw://0348a30fedbea579320af2e7b3518296e640097e97763a10af3185302056bd45","dweb:/ipfs/QmXWsaSFbhg8d2pdo7bDwvsD1gVWqPUw4ZK94qXEFEevQw"],"license":"GPL-2.0-or-later"},"lib/v3-core/contracts/interfaces/IUniswapV3Pool.sol":{"keccak256":"0x4e64844c56061cd90e0a80de73534a9166704c43eed579eb83f90bc2780ce968","urls":["bzz-raw://cba4fab5cebdddf644b901994a7f0f52b98885d4c56012f4dc51d52c2bf9de0e","dweb:/ipfs/QmVyyrRmqXrAiapewWunRVgiPVFJHpH2hKiE1py1svMSNV"],"license":"GPL-2.0-or-later"},"lib/v3-core/contracts/interfaces/pool/IUniswapV3PoolActions.sol":{"keccak256":"0x9453dd0e7442188667d01d9b65de3f1e14e9511ff3e303179a15f6fc267f7634","urls":["bzz-raw://982f4328f956c3e60e67501e759eb292ac487f76460c774c50e9ae4fcc92aae5","dweb:/ipfs/QmRnzEDsaqtd9PJEVcgQi7p5aV5pMSvRUoGZJAdwFUJxgZ"],"license":"GPL-2.0-or-later"},"lib/v3-core/contracts/interfaces/pool/IUniswapV3PoolDerivedState.sol":{"keccak256":"0xe603ac5b17ecdee73ba2b27efdf386c257a19c14206e87eee77e2017b742d9e5","urls":["bzz-raw://8febc9bdb399a4d94bb89f5377732652e2400e4a8dee808201ade6848f9004e7","dweb:/ipfs/QmaKDqYYFU4d2W2iN77aDHptfbFmYZRrMYXHeGpJmM8C1c"],"license":"GPL-2.0-or-later"},"lib/v3-core/contracts/interfaces/pool/IUniswapV3PoolErrors.sol":{"keccak256":"0xf80abf13fb1fafc127ba4e792f240dd8ea7c8c893978cdfd8439c27fae9a037b","urls":["bzz-raw://b04fc72a656bbf3631e9c2e67b9870a2d9d235185e833fe050e9606e6816a9aa","dweb:/ipfs/QmUcz4bkEkJ9pwzFu1C3n97hBQ3st9U6qTAqCdyFwddKco"],"license":"GPL-2.0-or-later"},"lib/v3-core/contracts/interfaces/pool/IUniswapV3PoolEvents.sol":{"keccak256":"0x8071514d0fe5d17d6fbd31c191cdfb703031c24e0ece3621d88ab10e871375cd","urls":["bzz-raw://d0b571930cc7488b1d546a7e9cea7c52d8b3c4e207da657ed0e0db7343b8cd03","dweb:/ipfs/QmaGK6vVwB95QSTR1XMYvrh7ivYAYZxi3fD7v6VMA4jZ39"],"license":"GPL-2.0-or-later"},"lib/v3-core/contracts/interfaces/pool/IUniswapV3PoolImmutables.sol":{"keccak256":"0xf6e5d2cd1139c4c276bdbc8e1d2b256e456c866a91f1b868da265c6d2685c3f7","urls":["bzz-raw://b99c8c9ae8e27ee6559e5866bea82cbc9ffc8247f8d15b7422a4deb287d4d047","dweb:/ipfs/QmfL8gaqt3ffAnm6nVj5ksuNpLygXuL3xq5VBqrkwC2JJ3"],"license":"GPL-2.0-or-later"},"lib/v3-core/contracts/interfaces/pool/IUniswapV3PoolOwnerActions.sol":{"keccak256":"0x759b78a2918af9e99e246dc3af084f654e48ef32bb4e4cb8a966aa3dcaece235","urls":["bzz-raw://64144fb96e1c7fdba87305acadb98a198d26a3d46c097cb3a666e567f6f29735","dweb:/ipfs/QmUnWVwN9FKB9uV5Pr8YfLpWZnYM2DENnRMaadZ492JS9u"],"license":"GPL-2.0-or-later"},"lib/v3-core/contracts/interfaces/pool/IUniswapV3PoolState.sol":{"keccak256":"0x44fa2ce1182f6c2f6bead3d1737804bf7e112252ae86e0f2e92f9b8249603f43","urls":["bzz-raw://54154e8665b98d65f5dc91b256551852cb47882180b501b260657122d207c0ea","dweb:/ipfs/QmcfemK1A2PXYrWB5SBFGERpMCderbFRb8BtTzQDj1sUBp"],"license":"GPL-2.0-or-later"}},"version":1},"ast":{"absolutePath":"contracts/libraries/FeesCalc.sol","id":2696,"exportedSymbols":{"FeesCalc":[2695],"IUniswapV3Pool":[51636],"LeftRight":[5031],"LiquidityChunk":[5192],"Math":[3628],"TokenId":[6292]},"nodeType":"SourceUnit","src":"37:9361:4","nodes":[{"id":2518,"nodeType":"PragmaDirective","src":"37:23:4","nodes":[],"literals":["solidity","^","0.8",".0"]},{"id":2520,"nodeType":"ImportDirective","src":"76:72:4","nodes":[],"absolutePath":"lib/v3-core/contracts/interfaces/IUniswapV3Pool.sol","file":"univ3-core/interfaces/IUniswapV3Pool.sol","nameLocation":"-1:-1:-1","scope":2696,"sourceUnit":51637,"symbolAliases":[{"foreign":{"id":2519,"name":"IUniswapV3Pool","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":51636,"src":"84:14:4","typeDescriptions":{}},"nameLocation":"-1:-1:-1"}],"unitAlias":""},{"id":2522,"nodeType":"ImportDirective","src":"162:41:4","nodes":[],"absolutePath":"contracts/libraries/Math.sol","file":"@libraries/Math.sol","nameLocation":"-1:-1:-1","scope":2696,"sourceUnit":3629,"symbolAliases":[{"foreign":{"id":2521,"name":"Math","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":3628,"src":"170:4:4","typeDescriptions":{}},"nameLocation":"-1:-1:-1"}],"unitAlias":""},{"id":2524,"nodeType":"ImportDirective","src":"220:47:4","nodes":[],"absolutePath":"contracts/types/LeftRight.sol","file":"@types/LeftRight.sol","nameLocation":"-1:-1:-1","scope":2696,"sourceUnit":5032,"symbolAliases":[{"foreign":{"id":2523,"name":"LeftRight","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":5031,"src":"228:9:4","typeDescriptions":{}},"nameLocation":"-1:-1:-1"}],"unitAlias":""},{"id":2526,"nodeType":"ImportDirective","src":"268:57:4","nodes":[],"absolutePath":"contracts/types/LiquidityChunk.sol","file":"@types/LiquidityChunk.sol","nameLocation":"-1:-1:-1","scope":2696,"sourceUnit":5193,"symbolAliases":[{"foreign":{"id":2525,"name":"LiquidityChunk","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":5192,"src":"276:14:4","typeDescriptions":{}},"nameLocation":"-1:-1:-1"}],"unitAlias":""},{"id":2528,"nodeType":"ImportDirective","src":"326:43:4","nodes":[],"absolutePath":"contracts/types/TokenId.sol","file":"@types/TokenId.sol","nameLocation":"-1:-1:-1","scope":2696,"sourceUnit":6293,"symbolAliases":[{"foreign":{"id":2527,"name":"TokenId","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":6292,"src":"334:7:4","typeDescriptions":{}},"nameLocation":"-1:-1:-1"}],"unitAlias":""},{"id":2695,"nodeType":"ContractDefinition","src":"1754:7643:4","nodes":[{"id":2532,"nodeType":"UsingForDirective","src":"1861:27:4","nodes":[],"global":false,"libraryName":{"id":2530,"name":"LeftRight","nameLocations":["1867:9:4"],"nodeType":"IdentifierPath","referencedDeclaration":5031,"src":"1867:9:4"},"typeName":{"id":2531,"name":"int256","nodeType":"ElementaryTypeName","src":"1881:6:4","typeDescriptions":{"typeIdentifier":"t_int256","typeString":"int256"}}},{"id":2535,"nodeType":"UsingForDirective","src":"1893:28:4","nodes":[],"global":false,"libraryName":{"id":2533,"name":"LeftRight","nameLocations":["1899:9:4"],"nodeType":"IdentifierPath","referencedDeclaration":5031,"src":"1899:9:4"},"typeName":{"id":2534,"name":"uint256","nodeType":"ElementaryTypeName","src":"1913:7:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}}},{"id":2538,"nodeType":"UsingForDirective","src":"2036:33:4","nodes":[],"global":false,"libraryName":{"id":2536,"name":"LiquidityChunk","nameLocations":["2042:14:4"],"nodeType":"IdentifierPath","referencedDeclaration":5192,"src":"2042:14:4"},"typeName":{"id":2537,"name":"uint256","nodeType":"ElementaryTypeName","src":"2061:7:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}}},{"id":2541,"nodeType":"UsingForDirective","src":"2158:26:4","nodes":[],"global":false,"libraryName":{"id":2539,"name":"TokenId","nameLocations":["2164:7:4"],"nodeType":"IdentifierPath","referencedDeclaration":6292,"src":"2164:7:4"},"typeName":{"id":2540,"name":"uint256","nodeType":"ElementaryTypeName","src":"2176:7:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}}},{"id":2602,"nodeType":"FunctionDefinition","src":"2851:1155:4","nodes":[],"body":{"id":2601,"nodeType":"Block","src":"3072:934:4","nodes":[],"statements":[{"assignments":[2557,2559],"declarations":[{"constant":false,"id":2557,"mutability":"mutable","name":"ammFeesPerLiqToken0X128","nameLocation":"3273:23:4","nodeType":"VariableDeclaration","scope":2601,"src":"3265:31:4","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":2556,"name":"uint256","nodeType":"ElementaryTypeName","src":"3265:7:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"},{"constant":false,"id":2559,"mutability":"mutable","name":"ammFeesPerLiqToken1X128","nameLocation":"3318:23:4","nodeType":"VariableDeclaration","scope":2601,"src":"3310:31:4","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":2558,"name":"uint256","nodeType":"ElementaryTypeName","src":"3310:7:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"}],"id":2570,"initialValue":{"arguments":[{"id":2561,"name":"univ3pool","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":2545,"src":"3408:9:4","typeDescriptions":{"typeIdentifier":"t_contract$_IUniswapV3Pool_$51636","typeString":"contract IUniswapV3Pool"}},{"id":2562,"name":"currentTick","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":2547,"src":"3435:11:4","typeDescriptions":{"typeIdentifier":"t_int24","typeString":"int24"}},{"arguments":[],"expression":{"argumentTypes":[],"expression":{"id":2563,"name":"liquidityChunk","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":2551,"src":"3464:14:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"id":2564,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberLocation":"3479:9:4","memberName":"tickLower","nodeType":"MemberAccess","referencedDeclaration":5156,"src":"3464:24:4","typeDescriptions":{"typeIdentifier":"t_function_internal_pure$_t_uint256_$returns$_t_int24_$attached_to$_t_uint256_$","typeString":"function (uint256) pure returns (int24)"}},"id":2565,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"3464:26:4","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_int24","typeString":"int24"}},{"arguments":[],"expression":{"argumentTypes":[],"expression":{"id":2566,"name":"liquidityChunk","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":2551,"src":"3508:14:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"id":2567,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberLocation":"3523:9:4","memberName":"tickUpper","nodeType":"MemberAccess","referencedDeclaration":5176,"src":"3508:24:4","typeDescriptions":{"typeIdentifier":"t_function_internal_pure$_t_uint256_$returns$_t_int24_$attached_to$_t_uint256_$","typeString":"function (uint256) pure returns (int24)"}},"id":2568,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"3508:26:4","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_int24","typeString":"int24"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_contract$_IUniswapV3Pool_$51636","typeString":"contract IUniswapV3Pool"},{"typeIdentifier":"t_int24","typeString":"int24"},{"typeIdentifier":"t_int24","typeString":"int24"},{"typeIdentifier":"t_int24","typeString":"int24"}],"id":2560,"name":"_getAMMSwapFeesPerLiquidityCollected","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":2694,"src":"3354:36:4","typeDescriptions":{"typeIdentifier":"t_function_internal_view$_t_contract$_IUniswapV3Pool_$51636_$_t_int24_$_t_int24_$_t_int24_$returns$_t_uint256_$_t_uint256_$","typeString":"function (contract IUniswapV3Pool,int24,int24,int24) view returns (uint256,uint256)"}},"id":2569,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"3354:194:4","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_tuple$_t_uint256_$_t_uint256_$","typeString":"tuple(uint256,uint256)"}},"nodeType":"VariableDeclarationStatement","src":"3251:297:4"},{"expression":{"id":2599,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftHandSide":{"id":2571,"name":"feesEachToken","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":2554,"src":"3769:13:4","typeDescriptions":{"typeIdentifier":"t_int256","typeString":"int256"}},"nodeType":"Assignment","operator":"=","rightHandSide":{"arguments":[{"arguments":[{"arguments":[{"arguments":[{"id":2593,"name":"ammFeesPerLiqToken1X128","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":2559,"src":"3953:23:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},{"id":2594,"name":"startingLiquidity","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":2549,"src":"3978:17:4","typeDescriptions":{"typeIdentifier":"t_uint128","typeString":"uint128"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_uint256","typeString":"uint256"},{"typeIdentifier":"t_uint128","typeString":"uint128"}],"expression":{"id":2591,"name":"Math","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":3628,"src":"3938:4:4","typeDescriptions":{"typeIdentifier":"t_type$_t_contract$_Math_$3628_$","typeString":"type(library Math)"}},"id":2592,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberLocation":"3943:9:4","memberName":"mulDiv128","nodeType":"MemberAccess","referencedDeclaration":3576,"src":"3938:14:4","typeDescriptions":{"typeIdentifier":"t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$","typeString":"function (uint256,uint256) pure returns (uint256)"}},"id":2595,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"3938:58:4","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_uint256","typeString":"uint256"}],"id":2590,"isConstant":false,"isLValue":false,"isPure":true,"lValueRequested":false,"nodeType":"ElementaryTypeNameExpression","src":"3931:6:4","typeDescriptions":{"typeIdentifier":"t_type$_t_int256_$","typeString":"type(int256)"},"typeName":{"id":2589,"name":"int256","nodeType":"ElementaryTypeName","src":"3931:6:4","typeDescriptions":{}}},"id":2596,"isConstant":false,"isLValue":false,"isPure":false,"kind":"typeConversion","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"3931:66:4","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_int256","typeString":"int256"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_int256","typeString":"int256"}],"id":2588,"isConstant":false,"isLValue":false,"isPure":true,"lValueRequested":false,"nodeType":"ElementaryTypeNameExpression","src":"3924:6:4","typeDescriptions":{"typeIdentifier":"t_type$_t_int128_$","typeString":"type(int128)"},"typeName":{"id":2587,"name":"int128","nodeType":"ElementaryTypeName","src":"3924:6:4","typeDescriptions":{}}},"id":2597,"isConstant":false,"isLValue":false,"isPure":false,"kind":"typeConversion","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"3924:74:4","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_int128","typeString":"int128"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_int128","typeString":"int128"}],"expression":{"arguments":[{"arguments":[{"arguments":[{"arguments":[{"id":2580,"name":"ammFeesPerLiqToken0X128","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":2557,"src":"3853:23:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},{"id":2581,"name":"startingLiquidity","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":2549,"src":"3878:17:4","typeDescriptions":{"typeIdentifier":"t_uint128","typeString":"uint128"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_uint256","typeString":"uint256"},{"typeIdentifier":"t_uint128","typeString":"uint128"}],"expression":{"id":2578,"name":"Math","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":3628,"src":"3838:4:4","typeDescriptions":{"typeIdentifier":"t_type$_t_contract$_Math_$3628_$","typeString":"type(library Math)"}},"id":2579,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberLocation":"3843:9:4","memberName":"mulDiv128","nodeType":"MemberAccess","referencedDeclaration":3576,"src":"3838:14:4","typeDescriptions":{"typeIdentifier":"t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$","typeString":"function (uint256,uint256) pure returns (uint256)"}},"id":2582,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"3838:58:4","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_uint256","typeString":"uint256"}],"id":2577,"isConstant":false,"isLValue":false,"isPure":true,"lValueRequested":false,"nodeType":"ElementaryTypeNameExpression","src":"3831:6:4","typeDescriptions":{"typeIdentifier":"t_type$_t_int256_$","typeString":"type(int256)"},"typeName":{"id":2576,"name":"int256","nodeType":"ElementaryTypeName","src":"3831:6:4","typeDescriptions":{}}},"id":2583,"isConstant":false,"isLValue":false,"isPure":false,"kind":"typeConversion","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"3831:66:4","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_int256","typeString":"int256"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_int256","typeString":"int256"}],"id":2575,"isConstant":false,"isLValue":false,"isPure":true,"lValueRequested":false,"nodeType":"ElementaryTypeNameExpression","src":"3824:6:4","typeDescriptions":{"typeIdentifier":"t_type$_t_int128_$","typeString":"type(int128)"},"typeName":{"id":2574,"name":"int128","nodeType":"ElementaryTypeName","src":"3824:6:4","typeDescriptions":{}}},"id":2584,"isConstant":false,"isLValue":false,"isPure":false,"kind":"typeConversion","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"3824:74:4","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_int128","typeString":"int128"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_int128","typeString":"int128"}],"expression":{"id":2572,"name":"feesEachToken","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":2554,"src":"3785:13:4","typeDescriptions":{"typeIdentifier":"t_int256","typeString":"int256"}},"id":2573,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberLocation":"3812:11:4","memberName":"toRightSlot","nodeType":"MemberAccess","referencedDeclaration":4663,"src":"3785:38:4","typeDescriptions":{"typeIdentifier":"t_function_internal_pure$_t_int256_$_t_int128_$returns$_t_int256_$attached_to$_t_int256_$","typeString":"function (int256,int128) pure returns (int256)"}},"id":2585,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"3785:114:4","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_int256","typeString":"int256"}},"id":2586,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberLocation":"3913:10:4","memberName":"toLeftSlot","nodeType":"MemberAccess","referencedDeclaration":4764,"src":"3785:138:4","typeDescriptions":{"typeIdentifier":"t_function_internal_pure$_t_int256_$_t_int128_$returns$_t_int256_$attached_to$_t_int256_$","typeString":"function (int256,int128) pure returns (int256)"}},"id":2598,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"3785:214:4","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_int256","typeString":"int256"}},"src":"3769:230:4","typeDescriptions":{"typeIdentifier":"t_int256","typeString":"int256"}},"id":2600,"nodeType":"ExpressionStatement","src":"3769:230:4"}]},"documentation":{"id":2542,"nodeType":"StructuredDocumentation","src":"2190:656:4","text":"@notice Calculate the AMM Swap/trading fees for a `liquidityChunk` of each token.\n @dev read from the uniswap pool and compute the accumulated fees from swapping activity.\n @param univ3pool the AMM/Uniswap pool where fees are collected from\n @param currentTick the current price tick\n @param startingLiquidity the liquidity of the option position leg deployed in the AMM\n @param liquidityChunk the chunk of liquidity of the option position leg deployed in the AMM\n @return feesEachToken the fees collected from the AMM for each token (LeftRight-packed) with token0 in the right slot and token1 in the left slot"},"functionSelector":"ab5dbb04","implemented":true,"kind":"function","modifiers":[],"name":"calculateAMMSwapFeesLiquidityChunk","nameLocation":"2860:34:4","parameters":{"id":2552,"nodeType":"ParameterList","parameters":[{"constant":false,"id":2545,"mutability":"mutable","name":"univ3pool","nameLocation":"2919:9:4","nodeType":"VariableDeclaration","scope":2602,"src":"2904:24:4","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_contract$_IUniswapV3Pool_$51636","typeString":"contract IUniswapV3Pool"},"typeName":{"id":2544,"nodeType":"UserDefinedTypeName","pathNode":{"id":2543,"name":"IUniswapV3Pool","nameLocations":["2904:14:4"],"nodeType":"IdentifierPath","referencedDeclaration":51636,"src":"2904:14:4"},"referencedDeclaration":51636,"src":"2904:14:4","typeDescriptions":{"typeIdentifier":"t_contract$_IUniswapV3Pool_$51636","typeString":"contract IUniswapV3Pool"}},"visibility":"internal"},{"constant":false,"id":2547,"mutability":"mutable","name":"currentTick","nameLocation":"2944:11:4","nodeType":"VariableDeclaration","scope":2602,"src":"2938:17:4","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_int24","typeString":"int24"},"typeName":{"id":2546,"name":"int24","nodeType":"ElementaryTypeName","src":"2938:5:4","typeDescriptions":{"typeIdentifier":"t_int24","typeString":"int24"}},"visibility":"internal"},{"constant":false,"id":2549,"mutability":"mutable","name":"startingLiquidity","nameLocation":"2973:17:4","nodeType":"VariableDeclaration","scope":2602,"src":"2965:25:4","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint128","typeString":"uint128"},"typeName":{"id":2548,"name":"uint128","nodeType":"ElementaryTypeName","src":"2965:7:4","typeDescriptions":{"typeIdentifier":"t_uint128","typeString":"uint128"}},"visibility":"internal"},{"constant":false,"id":2551,"mutability":"mutable","name":"liquidityChunk","nameLocation":"3008:14:4","nodeType":"VariableDeclaration","scope":2602,"src":"3000:22:4","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":2550,"name":"uint256","nodeType":"ElementaryTypeName","src":"3000:7:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"}],"src":"2894:134:4"},"returnParameters":{"id":2555,"nodeType":"ParameterList","parameters":[{"constant":false,"id":2554,"mutability":"mutable","name":"feesEachToken","nameLocation":"3057:13:4","nodeType":"VariableDeclaration","scope":2602,"src":"3050:20:4","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_int256","typeString":"int256"},"typeName":{"id":2553,"name":"int256","nodeType":"ElementaryTypeName","src":"3050:6:4","typeDescriptions":{"typeIdentifier":"t_int256","typeString":"int256"}},"visibility":"internal"}],"src":"3049:22:4"},"scope":2695,"stateMutability":"view","virtual":false,"visibility":"public"},{"id":2694,"nodeType":"FunctionDefinition","src":"4700:4695:4","nodes":[],"body":{"id":2693,"nodeType":"Block","src":"4946:4449:4","nodes":[],"statements":[{"assignments":[null,null,2620,2622,null,null,null,null],"declarations":[null,null,{"constant":false,"id":2620,"mutability":"mutable","name":"lowerOut0","nameLocation":"5499:9:4","nodeType":"VariableDeclaration","scope":2693,"src":"5491:17:4","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":2619,"name":"uint256","nodeType":"ElementaryTypeName","src":"5491:7:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"},{"constant":false,"id":2622,"mutability":"mutable","name":"lowerOut1","nameLocation":"5518:9:4","nodeType":"VariableDeclaration","scope":2693,"src":"5510:17:4","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":2621,"name":"uint256","nodeType":"ElementaryTypeName","src":"5510:7:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"},null,null,null,null],"id":2627,"initialValue":{"arguments":[{"id":2625,"name":"tickLower","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":2610,"src":"5555:9:4","typeDescriptions":{"typeIdentifier":"t_int24","typeString":"int24"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_int24","typeString":"int24"}],"expression":{"id":2623,"name":"univ3pool","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":2606,"src":"5539:9:4","typeDescriptions":{"typeIdentifier":"t_contract$_IUniswapV3Pool_$51636","typeString":"contract IUniswapV3Pool"}},"id":2624,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberLocation":"5549:5:4","memberName":"ticks","nodeType":"MemberAccess","referencedDeclaration":52059,"src":"5539:15:4","typeDescriptions":{"typeIdentifier":"t_function_external_view$_t_int24_$returns$_t_uint128_$_t_int128_$_t_uint256_$_t_uint256_$_t_int56_$_t_uint160_$_t_uint32_$_t_bool_$","typeString":"function (int24) view external returns (uint128,int128,uint256,uint256,int56,uint160,uint32,bool)"}},"id":2626,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"5539:26:4","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_tuple$_t_uint128_$_t_int128_$_t_uint256_$_t_uint256_$_t_int56_$_t_uint160_$_t_uint32_$_t_bool_$","typeString":"tuple(uint128,int128,uint256,uint256,int56,uint160,uint32,bool)"}},"nodeType":"VariableDeclarationStatement","src":"5486:79:4"},{"assignments":[null,null,2629,2631,null,null,null,null],"declarations":[null,null,{"constant":false,"id":2629,"mutability":"mutable","name":"upperOut0","nameLocation":"5588:9:4","nodeType":"VariableDeclaration","scope":2693,"src":"5580:17:4","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":2628,"name":"uint256","nodeType":"ElementaryTypeName","src":"5580:7:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"},{"constant":false,"id":2631,"mutability":"mutable","name":"upperOut1","nameLocation":"5607:9:4","nodeType":"VariableDeclaration","scope":2693,"src":"5599:17:4","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":2630,"name":"uint256","nodeType":"ElementaryTypeName","src":"5599:7:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"},null,null,null,null],"id":2636,"initialValue":{"arguments":[{"id":2634,"name":"tickUpper","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":2612,"src":"5644:9:4","typeDescriptions":{"typeIdentifier":"t_int24","typeString":"int24"}}],"expression":{"argumentTypes":[{"typeIdentifier":"t_int24","typeString":"int24"}],"expression":{"id":2632,"name":"univ3pool","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":2606,"src":"5628:9:4","typeDescriptions":{"typeIdentifier":"t_contract$_IUniswapV3Pool_$51636","typeString":"contract IUniswapV3Pool"}},"id":2633,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberLocation":"5638:5:4","memberName":"ticks","nodeType":"MemberAccess","referencedDeclaration":52059,"src":"5628:15:4","typeDescriptions":{"typeIdentifier":"t_function_external_view$_t_int24_$returns$_t_uint128_$_t_int128_$_t_uint256_$_t_uint256_$_t_int56_$_t_uint160_$_t_uint32_$_t_bool_$","typeString":"function (int24) view external returns (uint128,int128,uint256,uint256,int56,uint160,uint32,bool)"}},"id":2635,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"5628:26:4","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_tuple$_t_uint128_$_t_int128_$_t_uint256_$_t_uint256_$_t_int56_$_t_uint160_$_t_uint32_$_t_bool_$","typeString":"tuple(uint128,int128,uint256,uint256,int56,uint160,uint32,bool)"}},"nodeType":"VariableDeclarationStatement","src":"5575:79:4"},{"id":2692,"nodeType":"UncheckedBlock","src":"5764:3625:4","statements":[{"condition":{"commonType":{"typeIdentifier":"t_int24","typeString":"int24"},"id":2639,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"id":2637,"name":"currentTick","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":2608,"src":"5792:11:4","typeDescriptions":{"typeIdentifier":"t_int24","typeString":"int24"}},"nodeType":"BinaryOperation","operator":"<","rightExpression":{"id":2638,"name":"tickLower","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":2610,"src":"5806:9:4","typeDescriptions":{"typeIdentifier":"t_int24","typeString":"int24"}},"src":"5792:23:4","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},"falseBody":{"condition":{"commonType":{"typeIdentifier":"t_int24","typeString":"int24"},"id":2655,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"id":2653,"name":"currentTick","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":2608,"src":"7002:11:4","typeDescriptions":{"typeIdentifier":"t_int24","typeString":"int24"}},"nodeType":"BinaryOperation","operator":">=","rightExpression":{"id":2654,"name":"tickUpper","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":2612,"src":"7017:9:4","typeDescriptions":{"typeIdentifier":"t_int24","typeString":"int24"}},"src":"7002:24:4","typeDescriptions":{"typeIdentifier":"t_bool","typeString":"bool"}},"falseBody":{"id":2689,"nodeType":"Block","src":"8009:1370:4","statements":[{"documentation":"current AMM tick is within the option position range (within the chunk)\nliquidity\n        feeGrowthGlobal0X128 = global fee growth\n                             = (all fees collected for the entire price range for token 0)\n\n                        \n     lowerOut0   upperOut0\n^v              ^v\n                     chunk    \n                              \n price tick\nL             U\n\ncurrent\ntick","expression":{"id":2677,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftHandSide":{"id":2669,"name":"feeGrowthInside0X128","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":2615,"src":"9188:20:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"Assignment","operator":"=","rightHandSide":{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":2676,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":2674,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"arguments":[],"expression":{"argumentTypes":[],"expression":{"id":2670,"name":"univ3pool","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":2606,"src":"9211:9:4","typeDescriptions":{"typeIdentifier":"t_contract$_IUniswapV3Pool_$51636","typeString":"contract IUniswapV3Pool"}},"id":2671,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberLocation":"9221:20:4","memberName":"feeGrowthGlobal0X128","nodeType":"MemberAccess","referencedDeclaration":52017,"src":"9211:30:4","typeDescriptions":{"typeIdentifier":"t_function_external_view$__$returns$_t_uint256_$","typeString":"function () view external returns (uint256)"}},"id":2672,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"9211:32:4","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"-","rightExpression":{"id":2673,"name":"lowerOut0","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":2620,"src":"9246:9:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"9211:44:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"-","rightExpression":{"id":2675,"name":"upperOut0","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":2629,"src":"9258:9:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"9211:56:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"9188:79:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"id":2678,"nodeType":"ExpressionStatement","src":"9188:79:4"},{"expression":{"id":2687,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftHandSide":{"id":2679,"name":"feeGrowthInside1X128","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":2617,"src":"9285:20:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"Assignment","operator":"=","rightHandSide":{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":2686,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":2684,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"arguments":[],"expression":{"argumentTypes":[],"expression":{"id":2680,"name":"univ3pool","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":2606,"src":"9308:9:4","typeDescriptions":{"typeIdentifier":"t_contract$_IUniswapV3Pool_$51636","typeString":"contract IUniswapV3Pool"}},"id":2681,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"memberLocation":"9318:20:4","memberName":"feeGrowthGlobal1X128","nodeType":"MemberAccess","referencedDeclaration":52023,"src":"9308:30:4","typeDescriptions":{"typeIdentifier":"t_function_external_view$__$returns$_t_uint256_$","typeString":"function () view external returns (uint256)"}},"id":2682,"isConstant":false,"isLValue":false,"isPure":false,"kind":"functionCall","lValueRequested":false,"nameLocations":[],"names":[],"nodeType":"FunctionCall","src":"9308:32:4","tryCall":false,"typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"-","rightExpression":{"id":2683,"name":"lowerOut1","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":2622,"src":"9343:9:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"9308:44:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"-","rightExpression":{"id":2685,"name":"upperOut1","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":2631,"src":"9355:9:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"9308:56:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"9285:79:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"id":2688,"nodeType":"ExpressionStatement","src":"9285:79:4"}]},"id":2690,"nodeType":"IfStatement","src":"6998:2381:4","trueBody":{"id":2668,"nodeType":"Block","src":"7028:975:4","statements":[{"documentation":"liquidity\n           upperOut0\n^v\n     \n     lowerOut0  \n^v chunk  \n                        \n price tick\nL        U \n\ncurrent\ntick","expression":{"id":2660,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftHandSide":{"id":2656,"name":"feeGrowthInside0X128","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":2615,"src":"7882:20:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"Assignment","operator":"=","rightHandSide":{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":2659,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"id":2657,"name":"upperOut0","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":2629,"src":"7905:9:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"-","rightExpression":{"id":2658,"name":"lowerOut0","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":2620,"src":"7917:9:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"7905:21:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"7882:44:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"id":2661,"nodeType":"ExpressionStatement","src":"7882:44:4"},{"expression":{"id":2666,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftHandSide":{"id":2662,"name":"feeGrowthInside1X128","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":2617,"src":"7944:20:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"Assignment","operator":"=","rightHandSide":{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":2665,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"id":2663,"name":"upperOut1","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":2631,"src":"7967:9:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"-","rightExpression":{"id":2664,"name":"lowerOut1","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":2622,"src":"7979:9:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"7967:21:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"7944:44:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"id":2667,"nodeType":"ExpressionStatement","src":"7944:44:4"}]}},"id":2691,"nodeType":"IfStatement","src":"5788:3591:4","trueBody":{"id":2652,"nodeType":"Block","src":"5817:1175:4","statements":[{"documentation":"Diagrams shown for token0, and applies for token1 the same\nL = lowerTick, U = upperTick\nliquidity         lowerOut0 (all fees collected in this price tick range for token0)\n            ^v (to MAX_TICK)\n\n                      upperOut0\n                     ^v\n           \n            chunk  \n                   \n price tick\n     L        U\n\ncurrent\ntick","expression":{"id":2644,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftHandSide":{"id":2640,"name":"feeGrowthInside0X128","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":2615,"src":"6840:20:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"Assignment","operator":"=","rightHandSide":{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":2643,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"id":2641,"name":"lowerOut0","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":2620,"src":"6863:9:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"-","rightExpression":{"id":2642,"name":"upperOut0","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":2629,"src":"6875:9:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"6863:21:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"6840:44:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"id":2645,"nodeType":"ExpressionStatement","src":"6840:44:4"},{"expression":{"id":2650,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftHandSide":{"id":2646,"name":"feeGrowthInside1X128","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":2617,"src":"6933:20:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"Assignment","operator":"=","rightHandSide":{"commonType":{"typeIdentifier":"t_uint256","typeString":"uint256"},"id":2649,"isConstant":false,"isLValue":false,"isPure":false,"lValueRequested":false,"leftExpression":{"id":2647,"name":"lowerOut1","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":2622,"src":"6956:9:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"nodeType":"BinaryOperation","operator":"-","rightExpression":{"id":2648,"name":"upperOut1","nodeType":"Identifier","overloadedDeclarations":[],"referencedDeclaration":2631,"src":"6968:9:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"6956:21:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"src":"6933:44:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"id":2651,"nodeType":"ExpressionStatement","src":"6933:44:4"}]}}]}]},"documentation":{"id":2603,"nodeType":"StructuredDocumentation","src":"4012:683:4","text":"@notice Calculate the fee growth that has occurred (per unit of liquidity) in the AMM/Uniswap for an\n option position's `liquidity chunk` within its tick range given.\n @dev extract the feeGrowth from the uniswap v3 pool.\n @param univ3pool the AMM pool where the leg is deployed\n @param currentTick the current price tick in the AMM\n @param tickLower the lower tick of the option position leg (a liquidity chunk)\n @param tickUpper the upper tick of the option position leg (a liquidity chunk)\n @return feeGrowthInside0X128 the fee growth in the AMM of token0\n @return feeGrowthInside1X128 the fee growth in the AMM of token1"},"implemented":true,"kind":"function","modifiers":[],"name":"_getAMMSwapFeesPerLiquidityCollected","nameLocation":"4709:36:4","parameters":{"id":2613,"nodeType":"ParameterList","parameters":[{"constant":false,"id":2606,"mutability":"mutable","name":"univ3pool","nameLocation":"4770:9:4","nodeType":"VariableDeclaration","scope":2694,"src":"4755:24:4","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_contract$_IUniswapV3Pool_$51636","typeString":"contract IUniswapV3Pool"},"typeName":{"id":2605,"nodeType":"UserDefinedTypeName","pathNode":{"id":2604,"name":"IUniswapV3Pool","nameLocations":["4755:14:4"],"nodeType":"IdentifierPath","referencedDeclaration":51636,"src":"4755:14:4"},"referencedDeclaration":51636,"src":"4755:14:4","typeDescriptions":{"typeIdentifier":"t_contract$_IUniswapV3Pool_$51636","typeString":"contract IUniswapV3Pool"}},"visibility":"internal"},{"constant":false,"id":2608,"mutability":"mutable","name":"currentTick","nameLocation":"4795:11:4","nodeType":"VariableDeclaration","scope":2694,"src":"4789:17:4","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_int24","typeString":"int24"},"typeName":{"id":2607,"name":"int24","nodeType":"ElementaryTypeName","src":"4789:5:4","typeDescriptions":{"typeIdentifier":"t_int24","typeString":"int24"}},"visibility":"internal"},{"constant":false,"id":2610,"mutability":"mutable","name":"tickLower","nameLocation":"4822:9:4","nodeType":"VariableDeclaration","scope":2694,"src":"4816:15:4","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_int24","typeString":"int24"},"typeName":{"id":2609,"name":"int24","nodeType":"ElementaryTypeName","src":"4816:5:4","typeDescriptions":{"typeIdentifier":"t_int24","typeString":"int24"}},"visibility":"internal"},{"constant":false,"id":2612,"mutability":"mutable","name":"tickUpper","nameLocation":"4847:9:4","nodeType":"VariableDeclaration","scope":2694,"src":"4841:15:4","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_int24","typeString":"int24"},"typeName":{"id":2611,"name":"int24","nodeType":"ElementaryTypeName","src":"4841:5:4","typeDescriptions":{"typeIdentifier":"t_int24","typeString":"int24"}},"visibility":"internal"}],"src":"4745:117:4"},"returnParameters":{"id":2618,"nodeType":"ParameterList","parameters":[{"constant":false,"id":2615,"mutability":"mutable","name":"feeGrowthInside0X128","nameLocation":"4894:20:4","nodeType":"VariableDeclaration","scope":2694,"src":"4886:28:4","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":2614,"name":"uint256","nodeType":"ElementaryTypeName","src":"4886:7:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"},{"constant":false,"id":2617,"mutability":"mutable","name":"feeGrowthInside1X128","nameLocation":"4924:20:4","nodeType":"VariableDeclaration","scope":2694,"src":"4916:28:4","stateVariable":false,"storageLocation":"default","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"},"typeName":{"id":2616,"name":"uint256","nodeType":"ElementaryTypeName","src":"4916:7:4","typeDescriptions":{"typeIdentifier":"t_uint256","typeString":"uint256"}},"visibility":"internal"}],"src":"4885:60:4"},"scope":2695,"stateMutability":"view","virtual":false,"visibility":"internal"}],"abstract":false,"baseContracts":[],"canonicalName":"FeesCalc","contractDependencies":[],"contractKind":"library","documentation":{"id":2529,"nodeType":"StructuredDocumentation","src":"371:1383:4","text":"@title Library for Fee Calculations.\n @notice Some options positions involve moving liquidity chunks to the AMM/Uniswap. Those chunks can then earn AMM swap fees.\n @dev\n @dev          When price tick moves within\n @dev          this liquidity chunk == an option leg within a `tokenId` option position:\n @dev          Fees accumulate.\n @dev                \n @dev     liquidity  \n @dev                          \n @dev                  :        Liquidity chunk\n @dev                                (an option position leg)\n @dev             \n @dev                            \n @dev                  :          \n @dev                            \n @dev                  :          \n @dev                            \n @dev           price\n @dev                    \n @dev                    \n @dev            Current price tick\n @dev              of the AMM\n @dev\n @dev Collect fees accumulated within option position legs (a leg is a liquidity chunk)\n @author Axicon Labs Limited"},"fullyImplemented":true,"linearizedBaseContracts":[2695],"name":"FeesCalc","nameLocation":"1762:8:4","scope":2696,"usedErrors":[]}],"license":"BUSL-1.1"},"id":4}